import{a as p,j as e}from"./state-Cs2e8pUQ.js";import{L as S}from"./vendor-CXKupAPx.js";import{u as O}from"./useCart-zVf0E27c.js";import{f as n}from"./formatCurrency-cXqTydV9.js";import{S as C}from"./SEO-Cc3YMzmF.js";import{u as j,a as E,p as P,d as q,R as L}from"./index-DxVr6bqt.js";import{g as F}from"./downloadService-CoA7xjay.js";function T({cartItems:t,estimatedTotal:l,onClose:a,onSuccess:u}){j(!0);const[m,d]=p.useState(!1),y=t.map(r=>`• ${r.title} (x${r.quantity}) - ${n(r.price)}`).join(`
`),b=new Date().toISOString().split("T")[0];p.useEffect(()=>{const r=o=>{o.key==="Escape"&&a()};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[a]);const h=async r=>{r.preventDefault(),d(!0);const o=r.currentTarget,i=new FormData(o);try{if((await fetch("https://formspree.io/f/xwpgdwbd",{method:"POST",body:i,headers:{Accept:"application/json"}})).ok){const x=E.getState().user,f=x==null?void 0:x.id;if(f){t.forEach(c=>{const g=P.find(k=>k.id===c.id);g!=null&&g.slug&&F(f,g.slug)});const N=i.get("po_number")||void 0,w=i.get("legal_name")||"",v=i.get("email")||"";q({id:crypto.randomUUID(),userId:f,email:v,company:w,items:t.map(c=>({title:c.title,type:c.type||"Software",price:c.price,billing:c.billing||"monthly"})),total:parseFloat(l.replace(/[^0-9.]/g,""))||0,status:"submitted",submittedAt:new Date().toISOString(),poNumber:N})}o.reset(),a(),u()}else alert("Oops! There was a problem submitting your form.")}catch{alert("Network error. Please try again.")}finally{d(!1)}};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",role:"dialog","aria-modal":"true","aria-label":"Request Quote / PO",children:[e.jsx("div",{className:"fixed inset-0",style:{backgroundColor:"rgba(0,0,0,0.5)"},onClick:a,"aria-hidden":"true"}),e.jsxs("div",{className:"relative bg-white w-full max-w-4xl max-h-[95vh] flex flex-col border-t-8 border-blueprint-blue shadow-2xl",children:[e.jsxs("header",{className:"p-6 border-b border-gray-100 flex justify-between items-center flex-shrink-0",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Request Quote / PO"}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-900 text-3xl","aria-label":"Close",children:"×"})]}),e.jsx("div",{className:"overflow-y-auto",children:e.jsxs("form",{onSubmit:h,className:"p-8 text-sm",children:[e.jsx("input",{type:"hidden",name:"cart_contents",value:JSON.stringify(t)}),e.jsx("input",{type:"hidden",name:"estimated_total",value:l}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"po-number",className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"PO Number (Optional)"}),e.jsx("input",{id:"po-number",type:"text",name:"po_number",className:"w-full border border-gray-300 p-2 focus:border-blueprint-blue focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"po-date",className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Date"}),e.jsx("input",{id:"po-date",type:"date",name:"po_date",required:!0,defaultValue:b,className:"w-full border border-gray-300 p-2 text-gray-900 focus:border-blueprint-blue focus:outline-none"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("fieldset",{className:"border border-gray-200 p-4 bg-gray-50",children:[e.jsx("legend",{className:"text-sm font-bold text-blueprint-blue px-2 uppercase tracking-wide",children:"1. Customer Information"}),e.jsxs("div",{className:"space-y-4 pt-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"po-legal-name",className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Legal Entity Name"}),e.jsx("input",{id:"po-legal-name",type:"text",name:"legal_name",required:!0,className:"w-full border border-gray-300 p-2 focus:border-blueprint-blue focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"po-email",className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Contact Email"}),e.jsx("input",{id:"po-email",type:"email",name:"email",required:!0,className:"w-full border border-gray-300 p-2 focus:border-blueprint-blue focus:outline-none"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{htmlFor:"po-address",className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Street Address"}),e.jsx("input",{id:"po-address",type:"text",name:"address",required:!0,className:"w-full border border-gray-300 p-2 focus:border-blueprint-blue focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"po-city",className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"City"}),e.jsx("input",{id:"po-city",type:"text",name:"city",required:!0,className:"w-full border border-gray-300 p-2 focus:border-blueprint-blue focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"po-state",className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"State"}),e.jsx("input",{id:"po-state",type:"text",name:"state",required:!0,maxLength:2,className:"w-full border border-gray-300 p-2 focus:border-blueprint-blue focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"po-zip",className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Zip Code"}),e.jsx("input",{id:"po-zip",type:"text",name:"zip",required:!0,maxLength:5,className:"w-full border border-gray-300 p-2 focus:border-blueprint-blue focus:outline-none"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("fieldset",{className:"border border-gray-200 p-4 bg-gray-50",children:[e.jsx("legend",{className:"text-sm font-bold text-blueprint-blue px-2 uppercase tracking-wide",children:"2. Order Summary"}),e.jsxs("div",{className:"space-y-4 pt-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"po-summary",className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Items in Cart"}),e.jsx("textarea",{id:"po-summary",name:"poProductSummary",readOnly:!0,value:y,className:"w-full border border-gray-300 p-2 bg-gray-100 h-24 font-mono text-xs resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"po-start-date",className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Requested Start Date"}),e.jsx("input",{id:"po-start-date",type:"date",name:"start_date",required:!0,className:"w-full border border-gray-300 p-2 focus:border-blueprint-blue focus:outline-none"})]})]})]}),e.jsxs("fieldset",{className:"border border-gray-200 p-4 bg-gray-50",children:[e.jsx("legend",{className:"text-sm font-bold text-blueprint-blue px-2 uppercase tracking-wide",children:"3. Deployment"}),e.jsxs("div",{className:"space-y-4 pt-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"po-cloud",className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Cloud Provider"}),e.jsxs("select",{id:"po-cloud",name:"deployment_location",className:"w-full border border-gray-300 p-2 focus:border-blueprint-blue focus:outline-none",children:[e.jsx("option",{value:"AWS",children:"AWS"}),e.jsx("option",{value:"Azure",children:"Azure"}),e.jsx("option",{value:"GCP",children:"GCP"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"po-tech-contact",className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Technical Contact Email (Optional)"}),e.jsx("input",{id:"po-tech-contact",type:"email",name:"tech_contact",className:"w-full border border-gray-300 p-2 focus:border-blueprint-blue focus:outline-none"})]})]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-4 mt-6 pt-6 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:a,className:"px-6 py-2 text-xs font-bold uppercase text-gray-500 hover:text-gray-800",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:m,className:"px-8 py-3 bg-blueprint-blue text-white font-bold uppercase tracking-widest text-[10px] hover:bg-blue-800 transition-colors disabled:opacity-50",children:m?"Processing...":"Submit Request"})]})]})})]})]})}function M({onClose:t}){return j(!0),p.useEffect(()=>{const l=a=>{a.key==="Escape"&&t()};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[t]),e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",role:"dialog","aria-modal":"true","aria-label":"Order Confirmation",children:[e.jsx("div",{className:"fixed inset-0",style:{backgroundColor:"rgba(0,0,0,0.5)"},onClick:t,"aria-hidden":"true"}),e.jsxs("div",{className:"relative bg-white shadow-xl w-full max-w-md text-center p-12 border-t-8 border-green-500",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-20 w-20 bg-green-100 mb-6",style:{borderRadius:"9999px"},children:e.jsx("svg",{className:"h-10 w-10 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Order Received!"}),e.jsx("p",{className:"text-gray-500 mb-8 text-sm",children:"Thank you for your request. Our team will process your PO and email you the confirmation and next steps shortly."}),e.jsx("button",{onClick:t,className:"w-full bg-black text-white font-bold py-3 uppercase tracking-widest text-xs hover:bg-gray-800",children:"Close"})]})]})}function Q(){const{items:t,remove:l,clear:a,totals:u}=O(),[m,d]=p.useState(!1),[y,b]=p.useState(!1),h=u.monthlyTotal,r=u.annualTotal,o=h+r,i=()=>{a(),b(!0)};return e.jsxs("main",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsx(C,{title:"Your Cart",description:"Review your selected Blueprint Marketplace items.",canonical:"/cart"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Your Quote Cart"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-12",children:[e.jsx("div",{className:"lg:col-span-8",children:e.jsx("div",{className:"sharp-card bg-white overflow-hidden",children:t.length>0?e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-3 text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Product / Service"}),e.jsx("th",{className:"text-left px-6 py-3 text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"text-left px-6 py-3 text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Billing"}),e.jsx("th",{className:"text-left px-6 py-3 text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Price"}),e.jsx("th",{className:"px-6 py-3 text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Action"})]})}),e.jsx("tbody",{children:t.map(s=>{const x=s.billing==="monthly"?`${n(s.price)} / mo`:n(s.price);return e.jsxs("tr",{children:[e.jsxs("td",{className:"py-4 px-6 border-b border-gray-100",children:[e.jsx("div",{className:"font-bold text-gray-900",children:s.title}),s.quantity>1&&e.jsxs("span",{className:"text-xs font-bold text-blueprint-blue bg-blue-50 px-2 py-1 mt-1 inline-block",children:["Qty: ",s.quantity]})]}),e.jsx("td",{className:"py-4 px-6 border-b border-gray-100 text-sm text-gray-500",children:s.type||"Software"}),e.jsx("td",{className:"py-4 px-6 border-b border-gray-100 text-sm text-gray-500 capitalize",children:s.billing||"-"}),e.jsx("td",{className:"py-4 px-6 border-b border-gray-100 font-mono text-sm text-gray-900",children:x}),e.jsx("td",{className:"py-4 px-6 border-b border-gray-100",children:e.jsx("button",{onClick:()=>l(s.id),className:"text-gray-400 hover:text-red-600 transition-colors","aria-label":`Remove ${s.title}`,children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]},s.id)})})]}):e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),e.jsx("p",{className:"text-gray-500 text-lg mb-2",children:"Your cart is currently empty."}),e.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Add items from the marketplace to request a quote."}),e.jsx(S,{to:L.HOME,className:"bg-blueprint-blue text-white font-bold py-3 px-6 uppercase tracking-widest text-xs hover:bg-blue-800 transition-colors inline-block",children:"Browse Marketplace"})]})})}),e.jsx("div",{className:"lg:col-span-4",children:e.jsxs("div",{className:"sharp-card p-6 bg-white sticky top-28",children:[e.jsx("h3",{className:"text-xs font-bold uppercase tracking-widest text-gray-400 mb-4",children:"Summary"}),e.jsxs("div",{className:"space-y-3 mb-6 border-b border-gray-100 pb-6",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Monthly Recurring"}),e.jsx("span",{className:"font-bold text-gray-900",children:n(h)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"One-Time Implementation"}),e.jsx("span",{className:"font-bold text-gray-900",children:n(r)})]})]}),e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("span",{className:"text-lg font-bold text-gray-900",children:"Total Est."}),e.jsx("span",{className:"text-xl font-bold text-blueprint-blue",children:n(o)})]}),e.jsx("button",{onClick:()=>{if(t.length===0){alert("Cart is empty");return}d(!0)},className:"w-full bg-blueprint-blue text-white font-bold py-4 uppercase tracking-widest text-xs hover:bg-blue-800 transition-colors",children:"Request Quote / PO"})]})})]}),m&&e.jsx(T,{cartItems:t,estimatedTotal:n(o),onClose:()=>d(!1),onSuccess:i}),y&&e.jsx(M,{onClose:()=>b(!1)})]})}export{Q as default};
