const o="blueprint_entitlements",s="blueprint_downloads",c="blueprint_terms_accepted",l="blueprint_download_rate";function i(t){try{return JSON.parse(localStorage.getItem(o)||"{}")[t]||[]}catch{return[]}}function S(t,e){const a=JSON.parse(localStorage.getItem(o)||"{}"),n=a[t]||[];n.some(r=>r.productSlug===e)||(n.push({productSlug:e,grantedAt:new Date().toISOString(),expiresAt:null}),a[t]=n,localStorage.setItem(o,JSON.stringify(a)))}function g(t,e){return i(t).some(n=>n.productSlug===e&&(!n.expiresAt||new Date(n.expiresAt)>new Date))}function m(t){try{return(JSON.parse(localStorage.getItem(s)||"{}")[t]||[]).sort((a,n)=>n.downloadedAt.localeCompare(a.downloadedAt))}catch{return[]}}function u(t,e,a){const n=JSON.parse(localStorage.getItem(s)||"{}"),r=n[t]||[];r.push({assetId:e,downloadedAt:new Date().toISOString(),fileName:a}),n[t]=r,localStorage.setItem(s,JSON.stringify(n))}function p(t){try{return!!JSON.parse(localStorage.getItem(c)||"{}")[t]}catch{return!1}}function d(t){const e=JSON.parse(localStorage.getItem(c)||"{}");e[t]=!0,localStorage.setItem(c,JSON.stringify(e))}function f(t){try{return(JSON.parse(localStorage.getItem(l)||"{}")[t]||[]).filter(n=>Date.now()-n<36e5).length<5}catch{return!0}}function I(t){const e=JSON.parse(localStorage.getItem(l)||"{}"),a=(e[t]||[]).filter(n=>Date.now()-n<36e5);a.push(Date.now()),e[t]=a,localStorage.setItem(l,JSON.stringify(e))}function O(t){return t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(1)} KB`:`${(t/(1024*1024)).toFixed(1)} MB`}export{u as a,d as b,f as c,m as d,i as e,O as f,S as g,p as h,g as i,I as r};
